<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MKT AP - ë§ˆì¼€íŒ… ìº˜ë¦°ë”</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            color: #2563eb;
        }

        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: #f3f4f6;
            border-radius: 20px;
            font-size: 13px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-connected {
            background: #10b981;
        }

        .status-disconnected {
            background: #ef4444;
        }

        .month-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .month-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .nav-btn {
            padding: 8px;
            border: none;
            background: #f3f4f6;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .nav-btn:hover {
            background: #e5e7eb;
        }

        .month-title {
            font-size: 20px;
            font-weight: 600;
        }

        .calendar-info {
            font-size: 14px;
            color: #6b7280;
        }

        .main-content {
            display: flex;
            gap: 24px;
        }

        .settings-panel {
            width: 320px;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .settings-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .admin-section {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .admin-title {
            font-weight: 600;
            color: #92400e;
            margin-bottom: 8px;
        }

        .admin-info {
            font-size: 13px;
            color: #92400e;
            margin-bottom: 12px;
        }

        .calendar-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .calendar-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .calendar-item:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .calendar-checkbox {
            margin-top: 2px;
        }

        .calendar-details {
            flex: 1;
            min-width: 0;
        }

        .calendar-name {
            font-weight: 500;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .calendar-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .calendar-description {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 2px;
        }

        .calendar-id {
            font-size: 11px;
            color: #9ca3af;
            font-family: monospace;
        }

        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .control-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
        }

        .calendar-grid {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .weekday {
            padding: 16px;
            text-align: center;
            font-weight: 600;
            color: #475569;
            border-right: 1px solid #e2e8f0;
            width: 100%;
            box-sizing: border-box;
        }

        .weekday:last-child {
            border-right: none;
        }

        .weekday.sunday {
            color: #ef4444;
            font-weight: 700;
        }

        .weekday.saturday {
            color: #3b82f6;
            font-weight: 700;
        }

        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-auto-rows: minmax(120px, auto);
        }

        .day-cell {
            min-height: 120px;
            max-height: 180px;
            padding: 8px;
            border-right: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
            background: white;
            position: relative;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .day-cell:last-child {
            border-right: none;
        }

        .day-cell.other-month {
            background: #f8fafc;
            color: #94a3b8;
        }

        .day-cell.today {
            background: #fef3c7;
            border: 2px solid #f59e0b;
        }

        .day-cell.sunday {
            background: #fef2f2;
        }

        .day-cell.saturday {
            background: #eff6ff;
        }

        .day-number.sunday {
            color: #ef4444;
            font-weight: 700;
        }

        .day-number.saturday {
            color: #3b82f6;
            font-weight: 700;
        }

        .day-number {
            font-weight: 500;
            margin-bottom: 6px;
        }

        .day-number.today {
            color: #2563eb;
            font-weight: 700;
        }

        .events {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .event {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 3px;
            color: white;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .event:hover {
            opacity: 0.8;
        }

        .event-more {
            font-size: 10px;
            color: #6b7280;
            text-align: center;
            margin-top: 2px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: #6b7280;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e5e7eb;
            border-top: 2px solid #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            color: #6b7280;
            font-size: 14px;
        }

        .hidden {
            display: none;
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #991b1b;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .settings-panel {
                width: 100%;
            }
            
            .header-top {
                flex-direction: column;
                gap: 16px;
            }
            
            .controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <h1 class="title">MKT AP</h1>
                <div class="controls">
                    <!-- ì—°ê²° ìƒíƒœ í‘œì‹œ -->
                    <div class="status-indicator">
                        <div class="status-dot" id="statusDot"></div>
                        <span id="statusText">Google API ë¡œë”© ì¤‘...</span>
                    </div>

                    <!-- í¸ì§‘ì ë¡œê·¸ì¸ -->
                    <button class="btn btn-primary" id="adminLoginBtn">
                        í¸ì§‘ì ë¡œê·¸ì¸
                    </button>

                    <!-- ë™ê¸°í™” ë²„íŠ¼ -->
                    <button class="btn btn-success" id="syncBtn">
                        <span id="syncIcon">ğŸ”„</span>
                        <span id="syncText">ë™ê¸°í™”</span>
                    </button>

                    <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
                    <button class="btn btn-danger hidden" id="logoutBtn">
                        í¸ì§‘ì ë¡œê·¸ì•„ì›ƒ
                    </button>

                    <!-- ì„¤ì • í† ê¸€ -->
                    <button class="btn btn-secondary" id="settingsToggleBtn">
                        âš™ï¸ ì„¤ì •
                    </button>
                </div>
            </div>

            <!-- ì›” ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="month-nav">
                <div class="month-controls">
                    <button class="nav-btn" id="prevMonthBtn">â€¹</button>
                    <h2 class="month-title" id="monthTitle">2025ë…„ 6ì›”</h2>
                    <button class="nav-btn" id="nextMonthBtn">â€º</button>
                </div>
                <div class="calendar-info" id="calendarInfo">
                    í¸ì§‘ìê°€ ì„¤ì •í•œ ìº˜ë¦°ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- ì„¤ì • íŒ¨ë„ -->
            <div class="settings-panel hidden" id="settingsPanel">
                <h3 class="settings-title">ìº˜ë¦°ë” ì„¤ì •</h3>
                
                <!-- API í‚¤ ì•ˆë‚´ -->
                <div class="error-message" id="apiKeyWarning" style="display: none;">
                    Google API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”. ì½”ë“œì˜ GOOGLE_CONFIG ë¶€ë¶„ì— ì‹¤ì œ API í‚¤ì™€ í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.
                </div>
                
                <!-- í¸ì§‘ì ì„¹ì…˜ -->
                <div class="admin-section">
                    <div class="admin-title">ğŸ“‹ í¸ì§‘ì ì „ìš©</div>
                    <div class="admin-info">í¸ì§‘ì ê³„ì •: pmktb2c@gmail.com</div>
                    <button class="btn btn-primary btn-small" id="adminLoginBtn2">
                        í¸ì§‘ìë¡œ ë¡œê·¸ì¸
                    </button>
                </div>

                <!-- ìº˜ë¦°ë” ëª©ë¡ -->
                <div id="calendarSection">
                    <div class="calendar-controls">
                        <span style="font-weight: 500;">êµ¬ê¸€ ìº˜ë¦°ë” ëª©ë¡</span>
                        <div class="control-buttons">
                            <button class="btn btn-primary btn-small" id="selectAllBtn">ì „ì²´ì„ íƒ</button>
                            <button class="btn btn-secondary btn-small" id="deselectAllBtn">ì „ì²´í•´ì œ</button>
                        </div>
                    </div>
                    
                    <div class="calendar-list" id="calendarList">
                        <div class="loading" id="loadingCalendars">
                            <div class="spinner"></div>
                            ë¡œê·¸ì¸ í›„ ìº˜ë¦°ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë©”ì¸ ìº˜ë¦°ë” -->
            <div class="calendar-grid">
                <!-- ìš”ì¼ í—¤ë” -->
                <div class="weekdays">
                    <div class="weekday sunday">ì¼</div>
                    <div class="weekday">ì›”</div>
                    <div class="weekday">í™”</div>
                    <div class="weekday">ìˆ˜</div>
                    <div class="weekday">ëª©</div>
                    <div class="weekday">ê¸ˆ</div>
                    <div class="weekday saturday">í† </div>
                </div>

                <!-- ë‚ ì§œ ê·¸ë¦¬ë“œ -->
                <div class="days-grid" id="daysGrid">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>í¸ì§‘ìê°€ ê³µê°œ ì„¤ì •í•œ êµ¬ê¸€ ìº˜ë¦°ë” ì¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentDate = new Date();
        let isAdminLoggedIn = false;
        let googleCalendars = [];
        let selectedCalendars = new Set();
        let calendarEvents = {};
        let isSettingsVisible = false;
        let publicCalendarIds = [];
        let publicCalendarSettings = [];
        let isApiReady = false;

        // Google API ì„¤ì • - ì‹¤ì œ í‚¤ë¡œ êµì²´í•´ì£¼ì„¸ìš”
        const GOOGLE_CONFIG = {
            apiKey: 'YOUR_GOOGLE_API_KEY_HERE',
            clientId: 'Y936288018291-3rrn8jj7ceabs5ho2q1hesrcb17vetj6.apps.googleusercontent.com',
            discoveryDoc: 'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest',
            scopes: 'https://www.googleapis.com/auth/calendar.readonly'
        };

        const ADMIN_EMAIL = 'pmktb2c@gmail.com';

        // DOM ìš”ì†Œë“¤ì„ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
        function getElement(id) {
            const element = document.getElementById(id);
            if (!element) {
                console.warn(`Element with id '${id}' not found`);
            }
            return element;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ í•¨ìˆ˜
        function attachEventListeners() {
            const adminLoginBtn = getElement('adminLoginBtn');
            const adminLoginBtn2 = getElement('adminLoginBtn2');
            const logoutBtn = getElement('logoutBtn');
            const syncBtn = getElement('syncBtn');
            const settingsToggleBtn = getElement('settingsToggleBtn');
            const prevMonthBtn = getElement('prevMonthBtn');
            const nextMonthBtn = getElement('nextMonthBtn');
            const selectAllBtn = getElement('selectAllBtn');
            const deselectAllBtn = getElement('deselectAllBtn');

            // í¸ì§‘ì ë¡œê·¸ì¸ ë²„íŠ¼ë“¤
            if (adminLoginBtn) {
                adminLoginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('í¸ì§‘ì ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­');
                    adminLogin();
                });
            }

            if (adminLoginBtn2) {
                adminLoginBtn2.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('í¸ì§‘ì ë¡œê·¸ì¸ ë²„íŠ¼2 í´ë¦­');
                    adminLogin();
                });
            }

            // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­');
                    adminLogout();
                });
            }

            // ë™ê¸°í™” ë²„íŠ¼
            if (syncBtn) {
                syncBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ë™ê¸°í™” ë²„íŠ¼ í´ë¦­');
                    syncCalendars();
                });
            }

            // ì„¤ì • í† ê¸€ ë²„íŠ¼
            if (settingsToggleBtn) {
                settingsToggleBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ì„¤ì • í† ê¸€ ë²„íŠ¼ í´ë¦­');
                    toggleSettings();
                });
            }

            // ì›” ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ë“¤
            if (prevMonthBtn) {
                prevMonthBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ì´ì „ ì›” ë²„íŠ¼ í´ë¦­');
                    changeMonth(-1);
                });
            }

            if (nextMonthBtn) {
                nextMonthBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ë‹¤ìŒ ì›” ë²„íŠ¼ í´ë¦­');
                    changeMonth(1);
                });
            }

            // ì „ì²´ ì„ íƒ/í•´ì œ ë²„íŠ¼ë“¤
            if (selectAllBtn) {
                selectAllBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ì „ì²´ ì„ íƒ ë²„íŠ¼ í´ë¦­');
                    selectAllCalendars(true);
                });
            }

            if (deselectAllBtn) {
                deselectAllBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('ì „ì²´ í•´ì œ ë²„íŠ¼ í´ë¦­');
                    selectAllCalendars(false);
                });
            }
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ë¡œë“œ ì™„ë£Œ, ì´ˆê¸°í™” ì‹œì‘');
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë¨¼ì € ë“±ë¡
            attachEventListeners();
            
            // UI ì—…ë°ì´íŠ¸
            updateMonthTitle();
            updateCalendarDisplay();
            updateLoginStatus();
            updateCalendarInfo();
            
            // Google API ì´ˆê¸°í™”
            initializeGoogleAPI();
            
            // ê³µê°œ ìº˜ë¦°ë” ë¡œë“œ (ì§€ì—°)
            setTimeout(loadPublicCalendars, 1000);
        });

        // Google API ì´ˆê¸°í™”
        async function initializeGoogleAPI() {
            console.log('Google API ì´ˆê¸°í™” ì‹œì‘...');
            
            const statusText = getElement('statusText');
            
            // API í‚¤ í™•ì¸
            if (GOOGLE_CONFIG.apiKey === 'YOUR_GOOGLE_API_KEY_HERE' || 
                GOOGLE_CONFIG.clientId === 'YOUR_GOOGLE_CLIENT_ID_HERE') {
                console.warn('Google API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                if (statusText) statusText.textContent = 'API í‚¤ ë¯¸ì„¤ì •';
                
                const apiKeyWarning = getElement('apiKeyWarning');
                if (apiKeyWarning) apiKeyWarning.style.display = 'block';
                
                updateLoginStatus();
                await loadPublicCalendars();
                return;
            }

            try {
                if (typeof gapi === 'undefined') {
                    console.error('Google API ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    if (statusText) statusText.textContent = 'API ë¡œë”© ì‹¤íŒ¨';
                    return;
                }

                await new Promise((resolve, reject) => {
                    gapi.load('client:auth2', {
                        callback: resolve,
                        onerror: reject
                    });
                });

                await gapi.client.init({
                    apiKey: GOOGLE_CONFIG.apiKey,
                    clientId: GOOGLE_CONFIG.clientId,
                    discoveryDocs: [GOOGLE_CONFIG.discoveryDoc],
                    scope: GOOGLE_CONFIG.scopes
                });

                console.log('Google API ì´ˆê¸°í™” ì™„ë£Œ');
                isApiReady = true;
                
                const authInstance = gapi.auth2.getAuthInstance();
                if (authInstance && authInstance.isSignedIn.get()) {
                    const user = authInstance.currentUser.get();
                    const profile = user.getBasicProfile();
                    if (profile.getEmail() === ADMIN_EMAIL) {
                        isAdminLoggedIn = true;
                        await loadGoogleCalendars();
                    }
                }

                updateLoginStatus();
                
                if (!isAdminLoggedIn) {
                    await loadPublicCalendars();
                }

            } catch (error) {
                console.error('Google API ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                if (statusText) statusText.textContent = 'API ì´ˆê¸°í™” ì‹¤íŒ¨';
                await loadPublicCalendars();
            }
        }

        // í¸ì§‘ì ë¡œê·¸ì¸
        async function adminLogin() {
            console.log('í¸ì§‘ì ë¡œê·¸ì¸ ì‹œë„...');
            
            if (!isApiReady) {
                alert('Google APIê°€ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const authInstance = gapi.auth2.getAuthInstance();
                if (!authInstance) {
                    console.error('Google Auth2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    alert('Google ë¡œê·¸ì¸ ì„œë¹„ìŠ¤ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                    return;
                }

                console.log('Google ë¡œê·¸ì¸ íŒì—… í‘œì‹œ...');
                const user = await authInstance.signIn();
                const profile = user.getBasicProfile();
                const email = profile.getEmail();
                
                console.log('ë¡œê·¸ì¸í•œ ì´ë©”ì¼:', email);
                
                if (email === ADMIN_EMAIL) {
                    isAdminLoggedIn = true;
                    updateLoginStatus();
                    await loadGoogleCalendars();
                    updateCalendarInfo();
                    console.log('í¸ì§‘ì ë¡œê·¸ì¸ ì™„ë£Œ');
                    alert('í¸ì§‘ì ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    alert(`í¸ì§‘ì ê³„ì •(${ADMIN_EMAIL})ìœ¼ë¡œë§Œ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ní˜„ì¬ ë¡œê·¸ì¸: ${email}`);
                    authInstance.signOut();
                }
            } catch (error) {
                console.error('ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
                if (error.error === 'popup_closed_by_user') {
                    alert('ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else if (error.error === 'access_denied') {
                    alert('ë¡œê·¸ì¸ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    alert('ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (error.details || error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            }
        }

        // í¸ì§‘ì ë¡œê·¸ì•„ì›ƒ
        async function adminLogout() {
            console.log('í¸ì§‘ì ë¡œê·¸ì•„ì›ƒ ì‹œë„...');
            
            try {
                if (isApiReady && gapi && gapi.auth2) {
                    const authInstance = gapi.auth2.getAuthInstance();
                    if (authInstance && authInstance.isSignedIn.get()) {
                        await authInstance.signOut();
                        console.log('Google ê³„ì • ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
                    }
                }
                
                // ìƒíƒœ ì´ˆê¸°í™”
                isAdminLoggedIn = false;
                googleCalendars = [];
                selectedCalendars.clear();
                calendarEvents = {};
                
                // UI ì—…ë°ì´íŠ¸
                updateLoginStatus();
                updateCalendarDisplay();
                updateCalendarInfo();
                
                // ê³µê°œ ìº˜ë¦°ë” ë¡œë“œ
                setTimeout(async () => {
                    await loadPublicCalendars();
                }, 500);
                
                console.log('í¸ì§‘ì ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
                alert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
                
            } catch (error) {
                console.error('ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);
                alert('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë¡œê·¸ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateLoginStatus() {
            const statusDot = getElement('statusDot');
            const statusText = getElement('statusText');
            const adminLoginBtn = getElement('adminLoginBtn');
            const adminLoginBtn2 = getElement('adminLoginBtn2');
            const logoutBtn = getElement('logoutBtn');
            const syncBtn = getElement('syncBtn');
            const syncText = getElement('syncText');

            if (isAdminLoggedIn) {
                if (statusDot) statusDot.className = 'status-dot status-connected';
                if (statusText) statusText.textContent = 'í¸ì§‘ì ì—°ë™ë¨';
                if (adminLoginBtn) adminLoginBtn.classList.add('hidden');
                if (adminLoginBtn2) adminLoginBtn2.classList.add('hidden');
                if (logoutBtn) logoutBtn.classList.remove('hidden');
                if (syncBtn) syncBtn.disabled = false;
                if (syncText) syncText.textContent = 'ë™ê¸°í™”';
            } else {
                if (statusDot) statusDot.className = 'status-dot status-connected';
                if (statusText) statusText.textContent = 'ê³µê°œ ìº˜ë¦°ë” ë³´ê¸°';
                if (adminLoginBtn) adminLoginBtn.classList.remove('hidden');
                if (adminLoginBtn2) adminLoginBtn2.classList.remove('hidden');
                if (logoutBtn) logoutBtn.classList.add('hidden');
                if (syncBtn) syncBtn.disabled = false;
                if (syncText) syncText.textContent = 'ìƒˆë¡œê³ ì¹¨';
            }
        }

        // ë™ê¸°í™” í•¨ìˆ˜
        async function syncCalendars() {
            const syncIcon = getElement('syncIcon');
            const syncBtn = getElement('syncBtn');
            
            if (syncIcon) syncIcon.style.animation = 'spin 1s linear infinite';
            if (syncBtn) syncBtn.disabled = true;

            try {
                if (isAdminLoggedIn) {
                    await loadEventsFromGoogle();
                } else {
                    await loadPublicCalendars();
                }
                
                setTimeout(() => {
                    if (syncIcon) syncIcon.style.animation = '';
                    if (syncBtn) syncBtn.disabled = false;
                    alert('ë™ê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                }, 1000);

            } catch (error) {
                console.error('ë™ê¸°í™” ì‹¤íŒ¨:', error);
                if (syncIcon) syncIcon.style.animation = '';
                if (syncBtn) syncBtn.disabled = false;
                alert('ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì„¤ì • íŒ¨ë„ í† ê¸€
        function toggleSettings() {
            const settingsPanel = getElement('settingsPanel');
            if (!settingsPanel) return;
            
            isSettingsVisible = !isSettingsVisible;
            
            if (isSettingsVisible) {
                settingsPanel.classList.remove('hidden');
            } else {
                settingsPanel.classList.add('hidden');
            }
        }

        // ì›” ë³€ê²½
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateMonthTitle();
            
            if (isAdminLoggedIn) {
                loadEventsFromGoogle();
            } else {
                loadPublicCalendars();
            }
            
            updateCalendarDisplay();
        }

        // ì›” ì œëª© ì—…ë°ì´íŠ¸
        function updateMonthTitle() {
            const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
            const monthTitle = getElement('monthTitle');
            if (monthTitle) {
                monthTitle.textContent = `${currentDate.getFullYear()}ë…„ ${monthNames[currentDate.getMonth()]}`;
            }
        }

        // ìº˜ë¦°ë” ì •ë³´ ì—…ë°ì´íŠ¸
        function updateCalendarInfo() {
            const calendarInfo = getElement('calendarInfo');
            if (!calendarInfo) return;
            
            if (isAdminLoggedIn) {
                calendarInfo.textContent = `${selectedCalendars.size}ê°œ ìº˜ë¦°ë” ì—°ë™ ì¤‘`;
            } else {
                const publicCount = publicCalendarIds.length;
                if (publicCount > 0) {
                    calendarInfo.textContent = `${publicCount}ê°œ ê³µê°œ ìº˜ë¦°ë” í‘œì‹œ ì¤‘`;
                } else {
                    calendarInfo.textContent = 'í¸ì§‘ìê°€ ìº˜ë¦°ë”ë¥¼ ì„¤ì •í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤';
                }
            }
        }

        // êµ¬ê¸€ ìº˜ë¦°ë” ëª©ë¡ ë¡œë“œ
        async function loadGoogleCalendars() {
            const calendarListEl = getElement('calendarList');
            if (calendarListEl) {
                calendarListEl.innerHTML = '<div class="loading"><div class="spinner"></div>ìº˜ë¦°ë” ëª©ë¡ ë¡œë”© ì¤‘...</div>';
            }

            try {
                const response = await gapi.client.calendar.calendarList.list();
                googleCalendars = response.result.items || [];
                
                renderCalendarList();
                
                const primaryCalendar = googleCalendars.find(cal => cal.id === 'primary');
                if (primaryCalendar) {
                    selectedCalendars.add('primary');
                    await loadEventsFromGoogle();
                }

            } catch (error) {
                console.error('ìº˜ë¦°ë” ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                if (calendarListEl) {
                    calendarListEl.innerHTML = '<div style="text-align: center; color: #ef4444;">ìº˜ë¦°ë” ëª©ë¡ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>';
                }
            }
        }

        // ìº˜ë¦°ë” ëª©ë¡ ë Œë”ë§
        function renderCalendarList() {
            const calendarListEl = getElement('calendarList');
            if (!calendarListEl) return;
            
            if (googleCalendars.length === 0) {
                calendarListEl.innerHTML = '<div style="text-align: center; color: #6b7280;">ìº˜ë¦°ë”ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            calendarListEl.innerHTML = googleCalendars.map(calendar => `
                <div class="calendar-item">
                    <input type="checkbox" 
                           class="calendar-checkbox" 
                           id="cal-${calendar.id}"
                           ${selectedCalendars.has(calendar.id) ? 'checked' : ''}
                           onchange="toggleCalendar('${calendar.id}')">
                    <div class="calendar-details">
                        <div class="calendar-name">
                            <div class="calendar-color" style="background-color: ${calendar.backgroundColor || '#4285f4'}"></div>
                            ${calendar.summary}
                        </div>
                        ${calendar.description ? `<div class="calendar-description">${calendar.description}</div>` : ''}
                        <div class="calendar-id">${calendar.id}</div>
                    </div>
                </div>
            `).join('');
        }

        // ìº˜ë¦°ë” ì„ íƒ/í•´ì œ
        function toggleCalendar(calendarId) {
            if (selectedCalendars.has(calendarId)) {
                selectedCalendars.delete(calendarId);
            } else {
                selectedCalendars.add(calendarId);
            }
            updateCalendarInfo();
            
            if (isAdminLoggedIn) {
                savePublicCalendarSettings();
                loadEventsFromGoogle();
            }
        }

        // ì „ì²´ ì„ íƒ/í•´ì œ
        function selectAllCalendars(selectAll) {
            if (selectAll) {
                googleCalendars.forEach(cal => selectedCalendars.add(cal.id));
            } else {
                selectedCalendars.clear();
            }
            
            renderCalendarList();
            updateCalendarInfo();
            
            if (isAdminLoggedIn) {
                savePublicCalendarSettings();
                loadEventsFromGoogle();
            }
        }

        // ê³µê°œ ìº˜ë¦°ë” ì„¤ì • ì €ì¥ (í¸ì§‘ì ì „ìš©)
        function savePublicCalendarSettings() {
            const publicSettings = {
                calendarIds: Array.from(selectedCalendars),
                calendarData: googleCalendars.filter(cal => selectedCalendars.has(cal.id)).map(cal => ({
                    id: cal.id,
                    summary: cal.summary,
                    description: cal.description,
                    backgroundColor: cal.backgroundColor || '#4285f4'
                }))
            };
            
            localStorage.setItem('publicCalendarSettings', JSON.stringify(publicSettings));
            publicCalendarIds = publicSettings.calendarIds;
            publicCalendarSettings = publicSettings.calendarData;
            
            console.log('ê³µê°œ ìº˜ë¦°ë” ì„¤ì • ì €ì¥ë¨:', publicSettings);
        }

        // êµ¬ê¸€ ìº˜ë¦°ë”ì—ì„œ ì´ë²¤íŠ¸ ë¡œë“œ (í¸ì§‘ì ì „ìš©)
        async function loadEventsFromGoogle() {
            if (selectedCalendars.size === 0) {
                calendarEvents = {};
                updateCalendarDisplay();
                return;
            }

            try {
                const startTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).toISOString();
                const endTime = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0, 23, 59, 59).toISOString();
                
                calendarEvents = {};

                for (const calendarId of selectedCalendars) {
                    const calendar = googleCalendars.find(cal => cal.id === calendarId);
                    if (!calendar) continue;

                    const response = await gapi.client.calendar.events.list({
                        calendarId: calendarId,
                        timeMin: startTime,
                        timeMax: endTime,
                        singleEvents: true,
                        orderBy: 'startTime'
                    });

                    const events = response.result.items || [];
                    events.forEach(event => {
                        const eventDate = event.start.date || event.start.dateTime.split('T')[0];
                        if (!calendarEvents[eventDate]) {
                            calendarEvents[eventDate] = [];
                        }
                        calendarEvents[eventDate].push({
                            id: event.id,
                            title: event.summary || '(ì œëª© ì—†ìŒ)',
                            calendar: calendarId,
                            color: calendar.backgroundColor || '#4285f4',
                            description: event.description || ''
                        });
                    });
                }

                updateCalendarDisplay();

            } catch (error) {
                console.error('ì´ë²¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ê³µê°œ ìº˜ë¦°ë” ë¡œë“œ (ì¼ë°˜ ì‚¬ìš©ììš©)
        async function loadPublicCalendars() {
            console.log('ê³µê°œ ìº˜ë¦°ë” ë¡œë“œ ì‹œì‘...');
            
            const savedSettings = localStorage.getItem('publicCalendarSettings');
            
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    publicCalendarIds = settings.calendarIds || [];
                    publicCalendarSettings = settings.calendarData || [];
                    
                    console.log('ì €ì¥ëœ ê³µê°œ ìº˜ë¦°ë” ì„¤ì •:', settings);
                    
                    if (publicCalendarIds.length > 0 && isApiReady) {
                        await loadPublicEvents(publicCalendarIds);
                        updateCalendarInfo();
                        
                        if (!isAdminLoggedIn) {
                            renderPublicCalendarList();
                        }
                    } else {
                        console.log('ê³µê°œ ìº˜ë¦°ë” IDê°€ ì—†ê±°ë‚˜ APIê°€ ì¤€ë¹„ë˜ì§€ ì•ŠìŒ');
                        updateCalendarInfo();
                    }
                } catch (error) {
                    console.error('ê³µê°œ ìº˜ë¦°ë” ì„¤ì • íŒŒì‹± ì˜¤ë¥˜:', error);
                    updateCalendarInfo();
                }
            } else {
                console.log('ì €ì¥ëœ ê³µê°œ ìº˜ë¦°ë” ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤.');
                
                if (!isAdminLoggedIn) {
                    const calendarListEl = getElement('calendarList');
                    if (calendarListEl) {
                        calendarListEl.innerHTML = `
                            <div style="text-align: center; padding: 20px; color: #6b7280;">
                                <div style="margin-bottom: 12px;">ğŸ“</div>
                                <div style="font-weight: 500; margin-bottom: 8px;">ì•„ì§ ê³µê°œëœ ìº˜ë¦°ë”ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                                <div style="font-size: 13px;">í¸ì§‘ìê°€ ìº˜ë¦°ë”ë¥¼ ì„¤ì •í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
                            </div>
                        `;
                    }
                }
                updateCalendarInfo();
            }
        }

        // ê³µê°œ ì´ë²¤íŠ¸ ë¡œë“œ
        async function loadPublicEvents(calendarIds) {
            if (!calendarIds || calendarIds.length === 0 || !isApiReady) return;

            try {
                const startTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).toISOString();
                const endTime = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0, 23, 59, 59).toISOString();
                
                calendarEvents = {};

                for (const calendarId of calendarIds) {
                    try {
                        const response = await gapi.client.calendar.events.list({
                            calendarId: calendarId,
                            timeMin: startTime,
                            timeMax: endTime,
                            singleEvents: true,
                            orderBy: 'startTime'
                        });

                        const events = response.result.items || [];
                        const calendarInfo = publicCalendarSettings.find(cal => cal.id === calendarId);
                        const calendarColor = calendarInfo ? calendarInfo.backgroundColor : '#10b981';
                        
                        events.forEach(event => {
                            const eventDate = event.start.date || event.start.dateTime.split('T')[0];
                            if (!calendarEvents[eventDate]) {
                                calendarEvents[eventDate] = [];
                            }
                            calendarEvents[eventDate].push({
                                id: event.id,
                                title: event.summary || '(ì œëª© ì—†ìŒ)',
                                calendar: calendarId,
                                color: calendarColor,
                                description: event.description || ''
                            });
                        });
                        
                        console.log(`ìº˜ë¦°ë” ${calendarId}ì—ì„œ ${events.length}ê°œ ì´ë²¤íŠ¸ ë¡œë“œë¨`);
                    } catch (error) {
                        console.log(`ìº˜ë¦°ë” ${calendarId} ë¡œë“œ ì‹¤íŒ¨ (ë¹„ê³µê°œì´ê±°ë‚˜ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ):`, error);
                    }
                }

                updateCalendarDisplay();
                console.log('ê³µê°œ ìº˜ë¦°ë” ì´ë²¤íŠ¸ ë¡œë“œ ì™„ë£Œ');

            } catch (error) {
                console.error('ê³µê°œ ì´ë²¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ê³µê°œ ìº˜ë¦°ë” ëª©ë¡ ë Œë”ë§ (ë¹„ë¡œê·¸ì¸ ìƒíƒœ)
        function renderPublicCalendarList() {
            const calendarListEl = getElement('calendarList');
            if (!calendarListEl) {
                console.error('calendarList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (publicCalendarSettings.length === 0) {
                calendarListEl.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #6b7280;">
                        <div style="margin-bottom: 12px;">ğŸ“</div>
                        <div style="font-weight: 500; margin-bottom: 8px;">ì•„ì§ ê³µê°œëœ ìº˜ë¦°ë”ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 13px;">í¸ì§‘ìê°€ ìº˜ë¦°ë”ë¥¼ ì„¤ì •í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                `;
                return;
            }

            console.log('ê³µê°œ ìº˜ë¦°ë” ëª©ë¡ ë Œë”ë§:', publicCalendarSettings);

            calendarListEl.innerHTML = `
                <div style="margin-bottom: 12px; padding: 8px; background: #f0f9ff; border-radius: 6px; font-size: 13px; color: #0369a1;">
                    ğŸ“– í¸ì§‘ìê°€ ê³µê°œí•œ ìº˜ë¦°ë” ëª©ë¡ (${publicCalendarSettings.length}ê°œ)
                </div>
                ${publicCalendarSettings.map(calendar => `
                    <div class="calendar-item" style="opacity: 0.9;">
                        <div style="width: 16px; height: 16px; background: #10b981; border-radius: 50%; margin-top: 2px;"></div>
                        <div class="calendar-details">
                            <div class="calendar-name">
                                <div class="calendar-color" style="background-color: ${calendar.backgroundColor}"></div>
                                ${calendar.summary}
                            </div>
                            ${calendar.description ? `<div class="calendar-description">${calendar.description}</div>` : ''}
                            <div class="calendar-id">${calendar.id}</div>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // ìº˜ë¦°ë” í™”ë©´ ì—…ë°ì´íŠ¸
        function updateCalendarDisplay() {
            const daysGrid = getElement('daysGrid');
            if (!daysGrid) return;
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            const prevMonth = new Date(year, month, 0);
            const prevMonthDays = prevMonth.getDate();
            
            let daysHTML = '';
            
            // ì´ì „ ë‹¬ ë‚ ì§œë“¤
            for (let i = startingDay - 1; i >= 0; i--) {
                const day = prevMonthDays - i;
                const date = new Date(year, month - 1, day);
                const dateStr = date.toISOString().split('T')[0];
                const events = calendarEvents[dateStr] || [];
                const dayOfWeek = date.getDay();
                
                let dayClasses = 'day-cell other-month';
                let dayNumberClasses = 'day-number';
                
                if (dayOfWeek === 0) {
                    dayClasses += ' sunday';
                    dayNumberClasses += ' sunday';
                } else if (dayOfWeek === 6) {
                    dayClasses += ' saturday';
                    dayNumberClasses += ' saturday';
                }
                
                daysHTML += `
                    <div class="${dayClasses}">
                        <div class="${dayNumberClasses}">${day}</div>
                        <div class="events">
                            ${events.slice(0, 3).map(event => 
                                `<div class="event" style="background-color: ${event.color}" title="${event.title}">${event.title}</div>`
                            ).join('')}
                            ${events.length > 3 ? `<div class="event-more">+${events.length - 3}ê°œ</div>` : ''}
                        </div>
                    </div>
                `;
            }
            
            // í˜„ì¬ ë‹¬ ë‚ ì§œë“¤
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateStr = date.toISOString().split('T')[0];
                const events = calendarEvents[dateStr] || [];
                const isToday = date.toDateString() === new Date().toDateString();
                const dayOfWeek = date.getDay();
                
                let dayClasses = 'day-cell';
                let dayNumberClasses = 'day-number';
                
                if (isToday) {
                    dayClasses += ' today';
                    dayNumberClasses += ' today';
                }
                
                if (dayOfWeek === 0) {
                    dayClasses += ' sunday';
                    dayNumberClasses += ' sunday';
                } else if (dayOfWeek === 6) {
                    dayClasses += ' saturday';
                    dayNumberClasses += ' saturday';
                }
                
                daysHTML += `
                    <div class="${dayClasses}">
                        <div class="${dayNumberClasses}">${day}</div>
                        <div class="events">
                            ${events.slice(0, 3).map(event => 
                                `<div class="event" style="background-color: ${event.color}" title="${event.title}">${event.title}</div>`
                            ).join('')}
                            ${events.length > 3 ? `<div class="event-more">+${events.length - 3}ê°œ</div>` : ''}
                        </div>
                    </div>
                `;
            }
            
            // ë‹¤ìŒ ë‹¬ ë‚ ì§œë“¤
            const totalCells = 42;
            const remainingCells = totalCells - (startingDay + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                const date = new Date(year, month + 1, day);
                const dateStr = date.toISOString().split('T')[0];
                const events = calendarEvents[dateStr] || [];
                const dayOfWeek = date.getDay();
                
                let dayClasses = 'day-cell other-month';
                let dayNumberClasses = 'day-number';
                
                if (dayOfWeek === 0) {
                    dayClasses += ' sunday';
                    dayNumberClasses += ' sunday';
                } else if (dayOfWeek === 6) {
                    dayClasses += ' saturday';
                    dayNumberClasses += ' saturday';
                }
                
                daysHTML += `
                    <div class="${dayClasses}">
                        <div class="${dayNumberClasses}">${day}</div>
                        <div class="events">
                            ${events.slice(0, 3).map(event => 
                                `<div class="event" style="background-color: ${event.color}" title="${event.title}">${event.title}</div>`
                            ).join('')}
                            ${events.length > 3 ? `<div class="event-more">+${events.length - 3}ê°œ</div>` : ''}
                        </div>
                    </div>
                `;
            }
            
            daysGrid.innerHTML = daysHTML;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¶”ê°€ ì•ˆì „ì¥ì¹˜
        window.addEventListener('load', function() {
            console.log('Window load ì´ë²¤íŠ¸ ë°œìƒ');
            
            // DOMì´ ì™„ì „íˆ ë¡œë“œë˜ì§€ ì•Šì€ ê²½ìš° ì¬ì‹œë„
            if (!document.getElementById('adminLoginBtn')) {
                console.log('DOM ìš”ì†Œë“¤ì´ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•ŠìŒ, ì¬ì‹œë„...');
                setTimeout(() => {
                    attachEventListeners();
                    updateLoginStatus();
                    updateCalendarInfo();
                }, 500);
            }
            
            // APIê°€ ì¤€ë¹„ëœ í›„ ê³µê°œ ìº˜ë¦°ë” ë¡œë“œ
            setTimeout(() => {
                if (!isAdminLoggedIn && isApiReady) {
                    console.log('ê³µê°œ ìº˜ë¦°ë” ì¬ë¡œë“œ ì‹œë„...');
                    loadPublicCalendars();
                }
            }, 3000);
        });

        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ (HTMLì—ì„œ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ë¥¼ ìœ„í•´)
        window.adminLogin = adminLogin;
        window.adminLogout = adminLogout;
        window.syncCalendars = syncCalendars;
        window.toggleSettings = toggleSettings;
        window.changeMonth = changeMonth;
        window.selectAllCalendars = selectAllCalendars;
        window.toggleCalendar = toggleCalendar;
    </script>
</body>
</html>
